{% extends  "tutors/tutors.html" %}
{% load static %}
{% block otherScripts %}
    <script type="text/javascript" src="{% static 'javascript/editGroup.js' %}"></script>
{% endblock %}
{% block main %}
    {% csrf_token %}
    <div class="container">
      <div class="row">
        <div class="col align-self-start">
            <br>
            <a class="btn mt-4" href="{% url 'tutorTasks' %}">
                <img src="{% static 'img/atras.png' %}" alt="Volver atrás" width="45px">
            </a>
        </div>
        <div class="col">
        <br>
            <div class="card" style="width: 50rem;">
              <div class="card-body">
                <h5 class="card-title">{{ task.title }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{ task.shortDescription }}</h6>
                  <hr/>
                  <p class="card-text">
                      <form action="{% url 'tutorTasksEdit' id=task.id %}" method="post" enctype="multipart/form-data">
                        <table>
                            {% for field in form %}
                                <tr>
                                    <td>
                                        {{ field.label_tag }}
                                    </td>
                                    <td>
                                        {% if field != form.users %}
                                            {{ field.errors }}
                                            {{ field }}
                                        {% else %}
                                            <div class="container">
                                                <div class="row card-title">
                                                  <div class="col">
                                                  </div>
                                                </div>
                                                <div class="card p-3">
                                                  <div class="row card-body d-flex justify-content-center">
                                                    <div class="col-5 text-center ">
                                                      <p class="editUser_sections">
                                                        Alumnos
                                                      </p>
                                                      <div class= "col ">
                                                        <input type="text" id="myInputAlumnos" style=" margin-left: -15px; margin-bottom: 10px; padding: 10px; width: 150px;" onkeyup="searchAlumnos()" placeholder="Introduce un nombre...">
                                                      </div>
                                                      <select class="selctpicker w-100" id="alumnos" multiple data-live-search="true" id="list-tab" name="alumnos">
                                                        {% for user in users %}
                                                        <option class="p-3 border-bottom" value="{{user.id}}">{{user.name}}</option>
                                                        {% endfor %}
                                                      </select>
                                                    </div>
                                                    <div class="mt-5">
                                                        <img src="{% static 'img/add.png' %}" alt="Añadir"class="mt-5" width="55px" onclick="addUser()" class="btn"><br>
                                                        <img src="{% static 'img/add.png' %}" style="transform: rotate(180deg)" alt="Añadir" class="mt-2"  width="55px" onclick="removeUser()">
                                                    </div>
                                                    <div class="col-5">
                                                      <p class="editUser_sections text-center">
                                                        Participantes
                                                      </p>
                                                      <div class= "col ">
                                                        <input type="text" id="myInputMiembros" style=" margin-left: -15px; margin-bottom: 10px; padding: 10px; width: 150px;" onkeyup="searchMiembros()" placeholder="Introduce un nombre...">
                                                      </div>
                                                      <select class="selctpicker w-100" id="miembros" name="listUsers" multiple>
                                                        {% for user in usersIn %}
                                                          <option class="p-3 border-bottom" value="{{ user.id }}">{{user.name}}</option>
                                                        {% endfor %}
                                                      </select>
                                                    </div>
                                                  </div>
                                                </div>
                                            </div>
                                        {% endif %}

                                        {% if field == form.category %}
                                            <button type="button" class="btn btn-info btn-sm" data-toggle="modal" data-target="#categoryModal">+</button>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if field.help_text %}
                                            {{ field.help_text }}
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if field == form.image and task.image.url != 'null' %}
                                            Icono actual:<br>
                                            <a href="/{{ task.image.url }}"><img style="width: 100px;" src="/{{ task.image.url }}"></a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                                <tr>
                                  <td>
                                    <input type="submit" value="Enviar" onclick="selectMiembrosItems()" class="btn btn-success" role="button">
                                  </td>
                                </tr>
                        </table>
                    </form>
                  </p>
              </div>
            </div>
        </div>
        <div class="col">
            <br>
            <div style="float:right; display: inline-block;">
                <a class="btn w-10 mb-1 p-2" role="button" data-toggle="modal" data-target="#statusModal" style="margin-left: 40%; border-color: rgb(255, 255, 255); border-style: solid;" href="#" >
                    <img src="{% static 'img/resoluciones.png' %}" alt="Resoluciones" width="50px"><span style="color: white; padding: 10px; font-size: 18px;">Resoluciones</span>
                </a>
                <br>
                <br>
                <a class="btn w-10 mb-1 p-2" role="button" data-toggle="modal" data-target="#ratingModal" style="margin-left: 40%; border-color: rgb(248, 222, 61); border-style: solid;" href="#" >
                    <img src="{% static 'img/rating.png' %}" alt="Valoraciones" width="50px"><span style="color: white; padding: 10px; font-size: 18px;">Valoraciones</span>
                </a>
                <br>
                <br>
                <a class="btn w-10 mb-1 p-2" role="button" style="width: 145px; margin-left: 40%; border-color: rgb(255, 0, 0); border-style: solid;" href="{% url 'tutorTasksDelete' id=task.id  %}" >
                    <img src="{% static 'img/eliminar.png' %}" alt="Eliminar tarea" width="50px"><span style="color: white; padding: 10px; font-size: 18px;">Eliminar</span>
                </a>
            </div>
        </div>
      </div>
    </div>
    {% include "tutors/task-category.html" with categoryForm=categoryForm %}
    {% include "tutors/task-solutions.html" with taskStatus=taskStatus %}
    {% include "tutors/task-rates.html" with task=task taskRates=ratings %}
{% endblock %}